<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í™ˆí˜ì´ì§€</title>
    <!-- CSS íŒŒì¼ ë¡œë“œ -->
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./bootstrap.min.css">
    <!-- JavaScript íŒŒì¼ ë¡œë“œ -->
    <script src="./bootstrap.bundle.js" defer></script>
    <script src="./script.js" defer></script>
</head>
<body>

<!-- Header í¬í•¨ -->
<div id="header"></div>

<!-- Body Content í¬í•¨ -->
<div id="mainContent"></div>

<!-- Footer í¬í•¨ -->
<div id="footer"></div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        /**
         * ğŸ“Œ ê³µí†µ ì»´í¬ë„ŒíŠ¸ ë¡œë“œ í•¨ìˆ˜
         */
        const loadComponent = (id, path) => {
            fetch(path)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`${path} íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.`);
                    }
                    return response.text();
                })
                .then(data => document.getElementById(id).innerHTML = data)
                .catch(error => console.error(`${path} Error:`, error));
        };

        // ğŸ“Œ Header, Body Content, Footer ë¶ˆëŸ¬ì˜¤ê¸°
        loadComponent('header', './header.html');
        loadComponent('mainContent', './body-content.html');
        loadComponent('footer', './footer.html');

        /**
         * ğŸ“Œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ ë° UI ì—…ë°ì´íŠ¸
         */
        function updateAuthUI() {
            const loginItem = document.getElementById('loginItem');
            const signupItem = document.getElementById('signupItem');
            const logoutItem = document.getElementById('logoutItem');
            const userWelcome = document.getElementById('userWelcome');
            const currentUser = document.getElementById('currentUser');
            const logoutLink = document.getElementById('logoutLink');

            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const currentUserName = localStorage.getItem('currentUser');

            if (isLoggedIn && currentUserName) {
                loginItem?.classList.add('d-none');
                signupItem?.classList.add('d-none');
                logoutItem?.classList.remove('d-none');
                userWelcome?.classList.remove('d-none');
                currentUser.textContent = currentUserName;
            } else {
                loginItem?.classList.remove('d-none');
                signupItem?.classList.remove('d-none');
                logoutItem?.classList.add('d-none');
                userWelcome?.classList.add('d-none');
            }

            // ë¡œê·¸ì•„ì›ƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            logoutLink?.addEventListener('click', () => {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('currentUser');
                alert('âœ… ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
                window.location.href = 'index.html';
            });
        }

        // ë¡œê·¸ì¸ ìƒíƒœ UI ì—…ë°ì´íŠ¸ (í—¤ë” ë¡œë“œ í›„ ì‹¤í–‰)
        setTimeout(updateAuthUI, 500);
    });
</script>
</body>
</html>
